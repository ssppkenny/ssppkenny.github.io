{"version":3,"sources":["pz15/views.cljs"],"mappings":"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","names":["pz15.views/dispatch-keypress-rules","re-frame.core/dispatch","pz15.views/dispatch-keydown-rules","pz15.views/send-key-event","e","solving","cljs.core/not","pz15.views/send-shuffle","pz15.views/on-cell-click","n","state","nc","pz15.bfs/next-cells","action","cljs.core/filterv","p__13576","vec__13577","cljs.core.nth","m","_","cljs.core._EQ_","cljs.core.println","cljs.core/seq","a","pz15.db/UP","pz15.db/DOWN","pz15.db/LEFT","pz15.db/RIGHT","pz15.views/on-cell-click1","pz15.views/main-panel","re_frame.core.subscribe","elapsed","field","reagent.core.create_class","cljs.core/deref","show-progress","iter__5523__auto__","s__13581","cljs.core/LazySeq","temp__5804__auto__","cljs.core/chunked-seq?","c__5521__auto__","size__5522__auto__","cljs.core/count","b__13583","cljs.core/chunk-buffer","i__13582","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__13580","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","l","cljs.core/random-uuid","s__13585","b__13587","i__13586","vec__13588","iter__13584","vec__13591","s__13595","b__13597","i__13596","vec__13598","iter__13594","vec__13601","i","pz15.bfs/target-state","cljs.core/chunk-first"],"sourcesContent":["(ns pz15.views\n  (:require\n   [re-frame.core :as re-frame]\n   [re-pressed.core :as rp]\n   [reagent.core :as reagent]\n   [clojure.core.async :as ca]\n   [pz15.events :as events]\n   [pz15.subs :as subs]\n   [pz15.db :as db]\n   [pz15.bfs :as bfs]))\n\n(defn dispatch-keypress-rules []\n  (re-frame/dispatch\n   [::rp/set-keypress-rules\n    {:event-keys [[[::events/key-left 1]\n                   [{:keyCode 72} ;;\n                    ]]\n                  [[::events/key-right 1]\n                   [{:keyCode 76} ;; \n                    ]]\n                  [[::events/key-up 1]\n                   [{:keyCode 75} ;; \n                    ]]\n                  [[::events/key-down 1]\n                   [{:keyCode 74} ;; \n                    ]]]\n     :clear-keys\n     [[{:keyCode 27} ;; escape\n       ]]}]))\n(defn dispatch-keydown-rules []\n  (re-frame/dispatch\n   [::rp/set-keydown-rules\n    {:event-keys [[[::events/shuffle 1]\n                   [{:keyCode 32} ;;\n                    ]]\n                  [[::events/key-left 1]\n                   [{:keyCode 72} ;;\n                    ]\n                   [{:keyCode 37} ;;\n                    ]]\n                  [[::events/key-right 1]\n                   [{:keyCode 76} ;; \n                    ]\n                   [{:keyCode 39} ;; \n                    ]]\n                  [[::events/key-up 1]\n                   [{:keyCode 75} ;; \n                    ]\n                   [{:keyCode 38} ;; \n                    ]]\n                  [[::events/new-solve 1]\n                   [{:keyCode 83} ;; \n                    ]]\n                  [[::events/key-down 1]\n                   [{:keyCode 74} ;; \n                    ]\n                   [{:keyCode 40} ;; \n                    ]]]\n     :clear-keys\n     [[{:keyCode 27} ;; escape\n       ]]}]))\n\n(defn send-key-event [e solving]\n  (when (not solving)\n    (re-frame/dispatch [e 1]) \n    )\n  )\n\n(defn send-shuffle [solving]\n (when (not solving)\n   (re-frame/dispatch [::events/shuffle 1])\n   ) \n  )\n\n(defn on-cell-click [n state]\n  (let [nc (bfs/next-cells state)\n    action (filterv (fn [[m _]] (= m n) )  nc)]\n    (println action)\n  (when (seq action) \n    (let [a (nth (nth action 0) 1)]\n     (cond \n      (= db/UP a) (re-frame/dispatch [::events/key-up 1])\n      (= db/DOWN a) (re-frame/dispatch [::events/key-down 1])\n      (= db/LEFT a) (re-frame/dispatch [::events/key-left 1])\n      (= db/RIGHT a) (re-frame/dispatch [::events/key-right 1])\n      ) \n      )\n    )\n  )\n  )\n\n(defn on-cell-click1 [n state]\n  (let [nc (bfs/next-cells state)]\n    (println nc)\n  )\n  )\n\n(defn main-panel []\n  (let [state (re-frame/subscribe [::subs/state])\n        elapsed (re-frame/subscribe [::subs/elapsed-seconds])\n        solving (re-frame/subscribe [::subs/solving])]\n    (let [field state]\n      (reagent/create-class\n       {:component-did-mount\n        (fn [] (dispatch-keydown-rules))\n        :reagent-render\n        (fn []\n          (let [show-progress @solving]\n            [:div.main-container\n             [:div.title-box [:div.title [:span {:style {:font-size \"25px\"}} \"15 Puzzle\"]]\n              [:div.game-box\n               (for [l (:board @field)]\n                 ^{:key (random-uuid)} [:div.row (for [[n i] l]\n                                                   ^{:key (random-uuid)} [:div.cell {:on-click (fn [e] (.preventDefault e) (on-cell-click n @state))}\n                                                                          (if (not (= n 0))\n                                                                            [:img {:src (str \"images/t\" n \".png\") :width \"50px\" :height \"50px\"}] \n                                                                            [:img {:src \"images/empty.png\" :width \"50px\" :height \"50px\"}])])])]\n\n              [:div {:style {:display \"inline-block\"}}\n               (if show-progress [:img {:src \"images/wait.gif\" :width \"30px\"}] [:div])]\n              [:div (if (= @field bfs/target-state) \"Solved!!!\" \"\")]\n              [:div (if (> @elapsed 0) (str \"Solution duration = \" @elapsed \" s\") \"\")]\n              [:div {:style {:text-align \"center\"}}\n               [:img {:src \"images/solve.jpg\" :width \"50px\" :on-click (fn [e] (.preventDefault e) (re-frame/dispatch [::events/new-solve 1]))}]\n               [:span \"Press s to solve\"]\n               [:p]\n               [:img {:src \"images/space.png\" :width \"150px\" :on-click (fn [e] (.preventDefault e) (send-shuffle show-progress) )}]\n               [:p]\n               [:span \"Press space to shuffle\"]]]]))}))))\n"]}